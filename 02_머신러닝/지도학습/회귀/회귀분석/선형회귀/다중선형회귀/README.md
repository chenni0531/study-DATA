# 다중 선형 회귀

> Multiple Linear Regression
>
> 계수들을 행렬로 표현하여 계산한 점을 제외하고는 단순 선형 회귀와 전반적인 내용은 같다! 

**두 개 이상의 독립변수로 종속변수를 설명**

[TOC]

![1](2_다중선형회귀.assets/1.jpg)

<br>

---

<br>

## 1. 회귀 모형 생성

**최소제곱추정법 (LSE; Least Square Estimation Method)**

오차의 제곱 합이 최소가 되도록 회귀 계수를 추정하는 방법

![2](2_다중선형회귀.assets/2.jpg)

![image-20210707102924677](2_다중선형회귀.assets/image-20210707102924677.png)

<br>

---

<br>

## 2. 이원분산분석 ANOVA 

### 2-1. 분산분석

> 제곱합 분해 Decomposition / 분산분석

- **SST (Total Sum of Square)**: 총 제곱합
- **SSR (Regression Sum of Square)**: 회귀 제곱합
- **SSE (Error Sum of Square)**: 오차 제곱합

| 변동요인 | 제곱합 (SS) | 자유도 | 평균제곱 (MS)       | 검정 통계량   |
| -------- | ----------- | ------ | ------------------- | ------------- |
| **회귀** | SSR         | k      | MSR = SSR / k       | F = MSR / MSE |
| **잔차** | SSE         | n-k-1  | MSE = SSE / (n-k-1) |               |
| **합계** | SST         | n-1    |                     |               |

![image-20210707102935009](2_다중선형회귀.assets/image-20210707102935009.png)

<br>

### 2-2. 회귀 모형 검정: F 검정

> 두 모집단의 분산의 차이가 있는지 검정

**회귀식의 유의성 검정** (**반응변수들과 설명변수 사이에 상관관계가 있는지**)

- F 통계량 = `표본 평균 간의 변동 (MSR) / 표본 내부의 변동 (MSE)`

- F 통계량이 큰 경우
  - 두 집단 간 분산의 차이가 존재한다는 것 의미
  - MSR > MSE: 평균들의 차이가 많이 난다는 것 ▶ 귀무가설 기각

```
귀무가설 H0: 두 모집단의 평균이 같다 (b1 = 0)
```

![image-20210707112025257](2_다중선형회귀.assets/image-20210707112025257.png)

<br>

---

<br>

## 3. 회귀 모형 검정: t 검정

> 모집단의 분산이나 표준편차를 알지 못할 때 모집단을 대표하는 표본으로부터 추정된 분산이나 표준편차로 검정

**개별 계수의 유의성 검정**

```
귀무가설 H0: 두 모집단의 평균이 같다 (b1 = 0)
```

- t 통계량 = `표본평균사이의 차이 / 표준오차` = `두 집단의 차이의 평균(X)를 표준오차(SE)로 나눈 값`

- t 통계량이 기각역(t α,(n-1) 이상)에 존재하고 유의확률(P-value) < α (0.05): 두 집단 간 평균의 차이가 유의미하다는 것 의미 ▶ 귀무가설 기각

![image-20210707112037362](2_다중선형회귀.assets/image-20210707112037362.png)

<br>

---

<br>

## 4. 예측

### 4-1. 평균값 예측과 신뢰구간

![image-20210707112054054](2_다중선형회귀.assets/image-20210707112054054.png)

<br>

### 4-2. 개별값 예측과 예측구간

![image-20210707112100499](2_다중선형회귀.assets/image-20210707112100499.png)
