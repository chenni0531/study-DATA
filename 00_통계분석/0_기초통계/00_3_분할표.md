# 00_3_분할표

명복형 또는 순서형 데이터의 도수를 표 형태로 기록한 것

- 독립성 검정: 카이 제곱 검정으로 변수 간에 의존 관계 여부 확인
- 적합도 검정: 도수가 특정 분포를 따르는지 확인
- 기계학습: 데이터의 Positive / Negative 예측

|       | A    | B    |
| ----- | ---- | ---- |
| **1** | 3    | 7    |
| **2** | 8    | 5    |

```r
> d <- data.frame(x=c("1", "2", "2", "1"), y=c("A", "B", "A", "B"), num=c(3, 5, 8, 7))
> xtabs(num ~ x + y, data=d)
   y
x   A B
  1 3 7
  2 8 5
```

<br>

## 1. 합과 비율의 계산

행 방향, 열 방향의 합과 전체 합

|                         | A    | B    | margin.table(xt, 1)       |
| ----------------------- | ---- | ---- | ------------------------- |
| **1**                   | 3    | 7    | 10                        |
| **2**                   | 8    | 5    | 13                        |
| **margin.table(xt, 2)** | 11   | 12   | **margin.table(xt)** = 23 |

```r
> margin.table(xt, 1)
x
 1  2 
10 13 

> margin.table(xt, 2)
y
 A  B 
11 12 

> margin.table(xt)
[1] 23
```

행 방향, 열 방향의 비율과 전체 비율

|       | A           | B           |      |
| ----- | ----------- | ----------- | ---- |
| **1** | 3/10 = 0.3  | 7/10 = 0.7  | 10   |
| **2** | 8/13 = 0.62 | 5/13 = 0.38 | 13   |

|       | A           | B           |
| ----- | ----------- | ----------- |
| **1** | 3/11 = 0.27 | 7/12 = 0.58 |
| **2** | 8/11 = 0.73 | 5/12 = 0.42 |
|       | 11          | 12          |

|       | A           | B           |      |
| ----- | ----------- | ----------- | ---- |
| **1** | 3/23 = 0.13 | 7/23 = 0.30 | 10   |
| **2** | 8/23 = 0.34 | 5/23 = 0.22 | 13   |
|       | 11          | 12          | 23   |

```r
> prop.table(xt, 1)
   y
x           A         B
  1 0.3000000 0.7000000
  2 0.6153846 0.3846154

> prop.table(xt, 2)
   y
x           A         B
  1 0.2727273 0.5833333
  2 0.7272727 0.4166667

> prop.table(xt)
   y
x           A         B
  1 0.1304348 0.3043478
  2 0.3478261 0.2173913
```

<br>

---

<br>

## 2. 독립성 검정

두 사건이 서로 영향을 주고 받지 않는지 확인

> 학생들의 성별에 따른 운동량에 차이가 있는지 독립성 검정
>
> 귀무가설: 성별과 운동은 독립이다

![image-20210704230303491](00_3_분할표.assets/image-20210704230303491.png)

|            | Freq | None | Some |
| ---------- | ---- | ---- | ---- |
| **Female** | 49   | 11   | 58   |
| **Male**   | 65   | 13   | 40   |

```r
> library(MASS)
> data(survey)
> xtabs(~ Sex + Exer, data=survey)
        Exer
Sex      Freq None Some
  Female   49   11   58
  Male     65   13   40
```

<br>

### 2-1. 카이제곱 검정

> p-value = 0.05731 > 0.05 이므로 귀무가설을 기각할 수 없다: 성별과 운동은 독립이라고 말할 수 있다

```r
> chisq.test(xtabs(~ Sex + Exer, data=survey))

	Pearson's Chi-squared test

data:  xtabs(~Sex + Exer, data = survey)
X-squared = 5.7184, df = 2, p-value = 0.05731
```

<br>

### 2-2. 피셔의 정확검정

표본 수가 적은 경우(기대 빈도가 5이하인 셀이 전체의 20%이상인 경우) 카이제곱 검정 대신 피셔의 정확 검정 사용

> p-value = 0.05556 > 0.05 이므로 귀무가설을 기각할 수 없다: 성별과 운동은 독립이라고 말할 수 있다

```r
> fisher.test(xtabs(~ Sex + Exer, data=survey))

	Fisher's Exact Test for Count Data

data:  xtabs(~Sex + Exer, data = survey)
p-value = 0.05556
alternative hypothesis: two.sided
```

<br>

---

<br>

## 3. 맥니마 검정

> McNemar Test

응답자의 성향이 사건 전후에 어떻게 달라지는지 확인

사건 전후에 결과에 변화가 없다면 `a+b = a+c` `c+d = b+d` -> `b=c` 확인

![image-20210704230313114](00_3_분할표.assets/image-20210704230313114.png)

|                | Test2 양성 | Test2음성 | 총계 |
| -------------- | ---------- | --------- | ---- |
| **Test1 양성** | a          | b         | a+b  |
| **Test1 음성** | c          | d         | c+d  |
| **총계**       | a+c        | b+d       | n    |

<br>

### 3-1. 맥니마 검정

> p-value = 4.115e-05 < 0.05 이므로 귀무가설 기각: 사건 전후에 투표 결과 차이가 있었다

|                    | 2nd Approve | 2nd Disapprove | 총계 |
| ------------------ | ----------- | -------------- | ---- |
| **1st Approve  **  | 794         | 150            | 944  |
| **1st Disapprove** | 86          | 570            | 656  |
| **총계**           | 880         | 720            | 1600 |

```r
> mcnemar.test(performance)

	McNemar's Chi-squared test with continuity correction

data:  perfomance
McNemar's chi-squared = 16.818, df = 1, p-value = 4.115e-05
```

<br>

### 3-2. 이항분포 검정

> b가 b+c의 절반에 해당하는지 확인하기
>
> p-value = 3.716e-05 < 0.05 이므로 귀무가설 기각: 86이 86 + 150의 절반이 아니다 -> 사건 전후에 투표 결과 차이가 있었다

```r
> binom.test(86, 86 + 150, .5)

	Exact binomial test

data:  86 and 86 + 150
number of successes = 86, number of trials = 236, p-value =
3.716e-05
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.3029404 0.4293268
sample estimates:
probability of success 
             0.3644068 
```

